{"name":"Django-concerns","tagline":"Django app for reporting privacy concerns","body":"# django-concerns\r\n\r\nA good use of thiapp was in a web app containing de-identifed patient information\r\n\r\n\r\n## Install\r\n\r\n```bash\r\npip install django-concerns\r\n```\r\n\r\n\r\n## Setup\r\n\r\nAdd `concerns` to `INSTALLED_APPS` along with the following Django contrib apps:\r\n\r\n```python\r\nINSTALLED_APPS = (\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.sites',\r\n    'concerns',\r\n    ...\r\n)\r\n```\r\n\r\nAt a minimum, the following middleware must be installed:\r\n\r\n```python\r\nMIDDLEWARE_CLASSES = (\r\n    'django.middleware.common.CommonMiddleware',\r\n    'django.contrib.sessions.middleware.SessionMiddleware',\r\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\r\n)\r\n```\r\n\r\nInclude the `concerns.urls` in the the `ROOT_URLCONF`:\r\n\r\n```python\r\nfrom django.conf.urls import url, patterns, include\r\n\r\nurlpatterns = patterns('',\r\n    url(r'^concerns/', include('concerns.urls')),\r\n    ...\r\n)\r\n```\r\n\r\n\r\n## Settings\r\n\r\n- `CONCERN_EMAIL_SUBJECT` - The subject-line of the email sent to managers. Defaults to `Concern Report for {site}` where `{site}` is a string formatting variable for the current site's name, e.g. `Concern Report for example.com`\r\n- `CONCERN_RESOLVERS` - A list or tuple with the same structure as `ADMINS` and `MANAGERS` of users who should receive an email when a concern is reported.\r\n- `CONCERN_STATUSES` - A list of statuses that a reported concern could be in during review. The first status in the list is used as the default for new concerns. Default are `New`, `In Review`, `Duplicate`, and `Closed`.\r\n\r\n\r\n## Templates\r\n\r\nThe templates that come with the django-concerns are functional, but _very_ minimal:\r\n\r\n- `concerns/concern_list.html` - Renders a list of concerns with links to their detail pages\r\n    - Context received:\r\n        - `concerns` - `Concern` queryset\r\n- `concerns/concern_detail.html`\r\n    - Context received:\r\n        - `concern` - `Concern` instance\r\n        - `form` - Minimal form for resolving the concern.\r\n- `concerns/report_concern.html`\r\n    - Context recieved:\r\n        - `form` - Minimal form for reporting a concern.\r\n\r\nAn email template is also provided and can be customized as well:\r\n\r\n- `concerns/concern_email.txt`\r\n    - Context recieved:\r\n        - `protocol` - The site's protocol, either `http` or `https` for constructing the permalink to the concern detail page.\r\n        - `site` - The `site` object which contains the domain for constructing the permalink.\r\n        - `concern` - The `concern` instance itself for including details about the concern or getting the absolute URL.\r\n\r\n\r\n## Usage\r\n\r\nThe recommended way for exposing a \"report a concern\" form in your application is having button that opens an in-page modal/dialog for filling out details of the concern. Most likely the concern they have is about something on the page they are currently viewing, so directing them to a separate page to fill out the form is not generally a good idea since they will lose the exact state of the page (in case it is not static).\r\n\r\nThe `Concern` model has a field `document` that is used for storing the HTML captured at the time of the concern was reported. JavaScript can be used to capture the HTML in the current state. We recommend using [jquery.freeze](http://cbmi.github.io/jquery.freeze/) which makes it trivial to _freeze_ the current state of the DOM. Note that if a modal is used, it should be hidden prior to freeze the DOM, otherwise the modal will visible in the HTML when the concern is reported.\r\n\r\n```javascript\r\n// Bind to button or listen for a event, freeze the dom and send\r\n// a POST to log the document. The server-side could write the data\r\n// to an HTML file for later viewing.\r\n$('#freezer').click(function(event) {\r\n    event.preventDefault();\r\n    $.post('/screenlog/', $.param({document: $.freeze()}));\r\n});\r\n```\r\n\r\n### Example: Bootstrap's Modal\r\n\r\nThis example assumes [Bootstrap 2.3.2](http://getbootstrap.com/2.3.2/) is being used (version 3 requires minor changes) as well as jquery.freeze.js (recommended above).\r\n\r\n**Modal HTML markup**\r\n\r\n```html\r\n<div id=\"report-concern-modal\" class=\"modal hide\">\r\n    <div class=\"modal-header\">\r\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n        <h3>Report Concern</h3>\r\n    </div>\r\n\r\n    <div class=\"modal-body\">\r\n        <p>When you click \"Submit Concern\", a copy of this Web page will be sent to the administrators. Please provide any additional details regarding the concern we might not be able to see on the page.</p>\r\n        <textarea class=\"input-block-level\" rows=\"4\" placeholder=\"Please describe the nature of the concern (optional)\"></textarea>\r\n    </div>\r\n\r\n    <div class=\"modal-footer\">\r\n        <button class=\"btn\" data-dismiss=\"modal\">Cancel</button>\r\n        <button data-submit=\"modal\" data-url=\"/concerns/report/\" class=\"btn btn-primary\">Submit Concern</button>\r\n    </div>\r\n</div>\r\n```\r\n\r\n**Anchor/button to open the modal**\r\n\r\n```html\r\n<a id=\"report-concern-toggle\" href=\"#report-concern-modal\" role=\"button\" class=\"btn\" data-toggle=\"modal\">Report Concern</a>\r\n```\r\n\r\n\r\n**JavaScript containing the submission logic**\r\n\r\n```javascript\r\n// Various elements of interest\r\nvar concernButton = $('#report-concern-toggle'),\r\n    concernModal = $('#report-concern-modal'),\r\n    concernComment = concernModal.find('textarea'),\r\n    concernSubmit = concernModal.find('[data-submit]');\r\n\r\n// In the unlikely event the POST fails, show a fallback message containing\r\n// and email address the user can contact directly.\r\nvar fallbackMessage = '<p class=\"text-error\">Unfortunately the submission \\\r\n    failed. Please contact us at <a href=\"mailto:foo@example.com\">foo@example.com</a> \\\r\n    with as much detail as you can about the nature of the concern. Thank you.</p>'\r\n\r\n// Bind to click event of the submission button\r\nconcernSubmit.on('click', function(event) {\r\n    event.preventDefault();\r\n    // Hide the modal before freezing the DOM\r\n    concernModal.modal('hide');\r\n\r\n    var data = $.param({\r\n        document: $.freeze(),\r\n        comment: concernComment.val(),\r\n    });\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        data: data,\r\n        url: concernSubmit.data('url'),\r\n        success: function(resp) {\r\n            // Clear comment box, temporarily show 'thank you' message on button\r\n            concernComment.val('');\r\n\r\n            var buttonText = concernButton.text();\r\n            concernButton.addClass('btn-success').text('Submitted. Thank You!')\r\n            setTimeout(function() {\r\n                concernButton.removeClass('btn-success').text(buttonText);\r\n            }, 3000);\r\n        },\r\n        error: function(xhr, code, error) {\r\n            // Re-open modal with fallback message\r\n            concernModal.modal('open');\r\n            concernComment.before(fallbackMessage);\r\n        }\r\n    });\r\n});\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}